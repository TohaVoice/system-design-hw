=== Потоки данных и высокоуровневое взаимодействие
ifndef::imagesdir[:imagesdir: {docdir}/images]


= Потоки данных и высокоуровневое взаимодействие
:icons: font

== Введение

Документ описывает ключевые сценарии взаимодействия между сервисами и внешними системами, а также потоки данных при основных операциях в системе. Акцент делается на событийно-ориентированной архитектуре и шаблонах Saga для обеспечения согласованности данных.

== Ключевые сценарии взаимодействия

=== 1. Создание и публикация объявления

[source,asciidoc]
image::Создание и публикация объявления.png[]
----

=== 2. Оформление заказа с оплатой и доставкой (Saga Pattern)

[source,asciidoc]
image::Оформление заказа с оплатой и доставкой.png[]
----

=== 3. Общение в чате между покупателем и продавцом

[source,asciidoc]
image::Общение в чате между покупателем и продавцом.png[]
----

=== 4. Смена статуса доставки и уведомления

[source,asciidoc]
image::Смена статуса доставки уведомления.png[]
----

== Паттерны взаимодействия

[cols="1,2,3", options="header"]
|===
| Паттерн | Использование | Пример
| Request-Response | Синхронные операции | Поиск объявлений, получение профиля
| Event-Driven | Асинхронная обработка | Уведомления, обновления статусов
| Saga (Orchestrator) | Распределенные транзакции | Оформление заказа с оплатой
| CQRS | Отделение чтения от записи | Поиск объявлений vs создание
| API Gateway | Единая точка входа | Маршрутизация, аутентификация
| Circuit Breaker | Защита от сбоев зависимостей | Интеграции с платежными системами
| Publish-Subscribe | Многоадресная рассылка | Уведомления для всех сервисов
| Polling | Периодическая проверка | Трекинг посылок
| Webhooks | Callback от внешних систем | Статусы платежей, доставки
|===